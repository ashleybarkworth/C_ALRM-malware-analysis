import requests
import os
import time
import argparse 
import json
import sys 
import VTScan as VT   
import FileScan as FS    
import HybridAnalysis as HY    
import analyze as a
         

def readReportFiles(inputFile):
    #TODO make this read each of lucas's json files and return a list of json
      
    hybridResult = parseHybridReport(inputFile)
    virusTotalResult = parseVirusTotalReport(inputFile)
    return virusTotalResult + hybridResult

def parseFileScanReport(inputFile):
    output = FS.controller(inputFile, 'FS')
    return output
    #return []
    
def parseVirusTotalReport(inputFile):
    output = VT.controller(inputFile,'VT')
    return output
    #return []
    
def parseAnyrunReport():
    return []

def parseHybridReport(inputFile):
    output = HY.controller(inputFile, 'HY')
    return output
    #return []

def get_report(inputFile):
    analysisReport = readReportFiles(inputFile)
    finalReport = a.calculateFinalVerdict(analysisReport)
    
    return json.dumps(finalReport)
